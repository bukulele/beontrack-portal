generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                      String            @id @default(uuid()) @db.Uuid
  email                   String            @unique @db.VarChar(254)
  passwordHash            String?           @map("password_hash") @db.VarChar(255)
  firstName               String?           @map("first_name") @db.VarChar(150)
  lastName                String?           @map("last_name") @db.VarChar(150)
  isActive                Boolean           @default(true) @map("is_active")
  isStaff                 Boolean           @default(false) @map("is_staff")
  isSuperuser             Boolean           @default(false) @map("is_superuser")
  createdAt               DateTime          @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt               DateTime          @updatedAt @map("updated_at") @db.Timestamptz(6)
  department              String?           @db.VarChar(100)
  emailVerified           Boolean           @default(false) @map("email_verified")
  location                String?           @db.VarChar(100)
  accounts                Account[]
  activityHistoryReviewed ActivityHistory[] @relation("ActivityHistoryReviewedBy")
  activityLogsPerformed   ActivityLog[]     @relation("ActivityLogPerformedBy")
  documentsReviewed       Document[]        @relation("DocumentReviewedBy")
  documentsUploaded       Document[]        @relation("DocumentUploadedBy")
  adjustmentsApproved     HoursAdjustment[] @relation("AdjustmentApprovedBy")
  adjustmentsCreated      HoursAdjustment[] @relation("AdjustmentCreatedBy")
  employeesCreated        OfficeEmployee[]  @relation("EmployeeCreatedBy")
  employeesUpdated        OfficeEmployee[]  @relation("EmployeeUpdatedBy")
  employeePortalLink      OfficeEmployee[]  @relation("EmployeePortalUser")
  sessions                Session[]
  timeAmendmentsApproved  TimeAmendment[]   @relation("TimeAmendmentApprovedBy")
  timeAmendmentsCreated   TimeAmendment[]   @relation("TimeAmendmentCreatedBy")
  timeApprovalsDecided    TimeApproval[]    @relation("TimeApprovalDecidedBy")
  timeBreaksCreated       TimeBreak[]       @relation("TimeBreakCreatedBy")
  timeEntriesCreated      TimeEntry[]       @relation("TimeEntryCreatedBy")
  roles                   UserRole[]
  wcbClaimsCreated        WcbClaim[]        @relation("WcbClaimCreatedBy")
  wcbClaimsUpdated        WcbClaim[]        @relation("WcbClaimUpdatedBy")

  @@map("users")
}

model OfficeEmployee {
  id                    String            @id @default(uuid()) @db.Uuid
  employeeId            String?           @unique @map("employee_id") @db.VarChar(50)
  firstName             String?           @map("first_name") @db.VarChar(100)
  lastName              String?           @map("last_name") @db.VarChar(100)
  email                 String?           @db.VarChar(254)
  phoneNumber           String?           @map("phone_number") @db.VarChar(20)
  emergencyContactName  String?           @map("emergency_contact_name") @db.VarChar(200)
  emergencyContactPhone String?           @map("emergency_contact_phone") @db.VarChar(20)
  addressLine1          String?           @map("address_line1") @db.VarChar(255)
  addressLine2          String?           @map("address_line2") @db.VarChar(255)
  city                  String?           @db.VarChar(100)
  stateProvince         String?           @map("state_province") @db.VarChar(100)
  postalCode            String?           @map("postal_code") @db.VarChar(20)
  country               String?           @db.VarChar(100)
  hireDate              DateTime?         @map("hire_date") @db.Date
  terminationDate       DateTime?         @map("termination_date") @db.Date
  jobTitle              String?           @map("job_title") @db.VarChar(100)
  department            String?           @db.VarChar(100)
  employmentType        EmploymentType?   @map("employment_type")
  officeLocation        String?           @map("office_location") @db.VarChar(100)
  dateOfBirth           DateTime?         @map("date_of_birth") @db.Date
  status                EmployeeStatus    @default(new)
  profilePhotoId        String?           @map("profile_photo_id") @db.Uuid
  createdAt             DateTime          @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt             DateTime          @updatedAt @map("updated_at") @db.Timestamptz(6)
  createdById           String            @map("created_by_id") @db.Uuid
  updatedById           String            @map("updated_by_id") @db.Uuid
  isDeleted             Boolean           @default(false) @map("is_deleted")
  deletedAt             DateTime?         @map("deleted_at") @db.Timestamptz(6)
  dateOfLeaving         DateTime?         @map("date_of_leaving") @db.Date
  reasonForLeaving      String?           @map("reason_for_leaving")
  remarksComments       String?           @map("remarks_comments")
  statusNote            String?           @map("status_note")
  canCheckinRemotely    Boolean           @default(false) @map("can_checkin_remotely")
  portalAccessEnabled   Boolean           @default(true) @map("portal_access_enabled")
  allowApplicationEdit  Boolean           @default(true) @map("allow_application_edit")
  userId                String?           @map("user_id") @db.Uuid
  signature             String?           @db.Text
  signatureDate         DateTime?         @map("signature_date") @db.Timestamptz(6)
  activityHistory       ActivityHistory[] @relation("EmployeeActivityHistory")
  createdBy             User              @relation("EmployeeCreatedBy", fields: [createdById], references: [id], onDelete: Cascade)
  profilePhoto          Document?         @relation("EmployeeProfilePhoto", fields: [profilePhotoId], references: [id])
  updatedBy             User              @relation("EmployeeUpdatedBy", fields: [updatedById], references: [id], onDelete: Cascade)
  portalUser            User?             @relation("EmployeePortalUser", fields: [userId], references: [id])
  // Removed wcbClaims relation - WCB claims now use generic entityType + entityId linking

  @@map("office_employees")
}

model Document {
  id                    String           @id @default(uuid()) @db.Uuid
  documentType          DocumentType     @map("document_type")
  filePath              String           @map("file_path") @db.VarChar(500)
  fileName              String           @map("file_name") @db.VarChar(255)
  mimeType              String           @map("mime_type") @db.VarChar(100)
  fileSize              Int              @map("file_size")
  version               Int              @default(1)
  metadata              Json?
  wasReviewed           Boolean          @default(false) @map("was_reviewed")
  reviewedById          String?          @map("reviewed_by_id") @db.Uuid
  reviewedAt            DateTime?        @map("reviewed_at") @db.Timestamptz(6)
  uploadedById          String           @map("uploaded_by_id") @db.Uuid
  createdAt             DateTime         @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt             DateTime         @updatedAt @map("updated_at") @db.Timestamptz(6)
  isDeleted             Boolean          @default(false) @map("is_deleted")
  deletedAt             DateTime?        @map("deleted_at") @db.Timestamptz(6)
  entityType            String           @map("entity_type") @db.VarChar(50)
  entityId              String           @map("entity_id") @db.Uuid
  reviewedBy            User?            @relation("DocumentReviewedBy", fields: [reviewedById], references: [id])
  uploadedBy            User             @relation("DocumentUploadedBy", fields: [uploadedById], references: [id])
  employeeProfilePhotos OfficeEmployee[] @relation("EmployeeProfilePhoto")

  @@index([entityType, entityId])
  @@index([documentType])
  @@map("documents")
}

/// Activity History - Employment, education, and other activities
/// Used for tracking applicant/employee activity over the last 10 years
model ActivityHistory {
  id               String         @id @default(uuid()) @db.Uuid
  employeeId       String         @map("employee_id") @db.Uuid
  activityType     ActivityType   @map("activity_type")
  description      String?
  startDate        DateTime       @map("start_date") @db.Date
  endDate          DateTime?      @map("end_date") @db.Date
  tillNow          Boolean        @default(false) @map("till_now")
  organizationName String?        @map("organization_name") @db.VarChar(255)
  roleOrPosition   String?        @map("role_or_position") @db.VarChar(255)
  location         String?        @db.VarChar(255)
  emailAddress     String?        @map("email_address") @db.VarChar(254)
  createdAt        DateTime       @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt        DateTime       @updatedAt @map("updated_at") @db.Timestamptz(6)
  isDeleted        Boolean        @default(false) @map("is_deleted")
  deletedAt        DateTime?      @map("deleted_at") @db.Timestamptz(6)
  reviewedAt       DateTime?      @map("reviewed_at") @db.Timestamptz(6)
  reviewedById     String?        @map("reviewed_by_id") @db.Uuid
  wasReviewed      Boolean        @default(false) @map("was_reviewed")
  employee         OfficeEmployee @relation("EmployeeActivityHistory", fields: [employeeId], references: [id], onDelete: Cascade)
  reviewedBy       User?          @relation("ActivityHistoryReviewedBy", fields: [reviewedById], references: [id])

  @@index([employeeId])
  @@index([startDate, endDate])
  @@map("activity_history")
}

model ActivityLog {
  id            String   @id @default(uuid()) @db.Uuid
  actionType    String   @map("action_type") @db.VarChar(50)
  fieldName     String?  @map("field_name") @db.VarChar(100)
  oldValue      String?  @map("old_value")
  newValue      String?  @map("new_value")
  performedById String   @map("performed_by_id") @db.Uuid
  createdAt     DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  entityType    String   @map("entity_type") @db.VarChar(50)
  entityId      String   @map("entity_id") @db.Uuid
  performedBy   User     @relation("ActivityLogPerformedBy", fields: [performedById], references: [id])

  @@index([entityType, entityId])
  @@map("activity_logs")
}

/// Status configuration for entity types
/// Stores available statuses, colors, and labels
model StatusConfig {
  id              String             @id @default(uuid()) @db.Uuid
  entityType      EntityType         @map("entity_type")
  statusCode      String             @map("status_code") @db.VarChar(50)
  statusLabel     String             @map("status_label") @db.VarChar(100)
  color           String             @db.VarChar(7)
  sortOrder       Int                @default(0) @map("sort_order")
  createdAt       DateTime           @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt       DateTime           @updatedAt @map("updated_at") @db.Timestamptz(6)
  transitionsFrom StatusTransition[] @relation("TransitionFrom")
  transitionsTo   StatusTransition[] @relation("TransitionTo")

  @@unique([entityType, statusCode])
  @@index([entityType])
  @@map("status_configs")
}

/// Status transition rules
/// Defines which statuses can transition to which (state machine)
model StatusTransition {
  id           String       @id @default(uuid()) @db.Uuid
  fromStatusId String       @map("from_status_id") @db.Uuid
  toStatusId   String       @map("to_status_id") @db.Uuid
  createdAt    DateTime     @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt    DateTime     @updatedAt @map("updated_at") @db.Timestamptz(6)
  fromStatus   StatusConfig @relation("TransitionFrom", fields: [fromStatusId], references: [id], onDelete: Cascade)
  toStatus     StatusConfig @relation("TransitionTo", fields: [toStatusId], references: [id], onDelete: Cascade)

  @@unique([fromStatusId, toStatusId])
  @@index([fromStatusId])
  @@map("status_transitions")
}

/// Roles define groups of users with similar responsibilities
/// e.g., 'admin', 'payroll', 'safety', 'dispatch', etc.
model Role {
  id          String       @id @default(uuid()) @db.Uuid
  name        String       @unique @db.VarChar(50)
  description String?
  isActive    Boolean      @default(true) @map("is_active")
  createdAt   DateTime     @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt   DateTime     @updatedAt @map("updated_at") @db.Timestamptz(6)
  permissions Permission[]
  users       UserRole[]

  @@map("roles")
}

/// Junction table for many-to-many User-Role relationship
model UserRole {
  id        String   @id @default(uuid()) @db.Uuid
  userId    String   @map("user_id") @db.Uuid
  roleId    String   @map("role_id") @db.Uuid
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  role      Role     @relation(fields: [roleId], references: [id], onDelete: Cascade)
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, roleId])
  @@index([userId])
  @@index([roleId])
  @@map("user_roles")
}

/// Permissions define what actions roles can perform on which resources
/// Supports entity-level, action-level, field-level, and record-level (ABAC) permissions
model Permission {
  id         String   @id @default(uuid()) @db.Uuid
  roleId     String   @map("role_id") @db.Uuid
  entityType String   @map("entity_type") @db.VarChar(50)
  actions    String[] @db.VarChar(20)
  fields     Json?
  conditions Json?
  createdAt  DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt  DateTime @updatedAt @map("updated_at") @db.Timestamptz(6)
  role       Role     @relation(fields: [roleId], references: [id], onDelete: Cascade)

  @@index([roleId])
  @@index([entityType])
  @@map("permissions")
}

/// Session management for Better Auth
model Session {
  id        String   @id @default(uuid()) @db.Uuid
  userId    String   @map("user_id") @db.Uuid
  token     String   @unique @db.VarChar(255)
  expiresAt DateTime @map("expires_at") @db.Timestamptz(6)
  ipAddress String?  @map("ip_address") @db.VarChar(45)
  userAgent String?  @map("user_agent")
  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamptz(6)
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([token])
  @@index([expiresAt])
  @@map("sessions")
}

/// OAuth/Social login accounts for Better Auth
model Account {
  id                    String    @id @default(uuid()) @db.Uuid
  userId                String    @map("user_id") @db.Uuid
  accountId             String    @map("account_id") @db.VarChar(255)
  providerId            String    @map("provider_id") @db.VarChar(100)
  accessToken           String?   @map("access_token")
  refreshToken          String?   @map("refresh_token")
  accessTokenExpiresAt  DateTime? @map("access_token_expires_at") @db.Timestamptz(6)
  refreshTokenExpiresAt DateTime? @map("refresh_token_expires_at") @db.Timestamptz(6)
  scope                 String?
  idToken               String?   @map("id_token")
  password              String?   @db.VarChar(255)
  createdAt             DateTime  @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt             DateTime  @updatedAt @map("updated_at") @db.Timestamptz(6)
  user                  User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([providerId])
  @@map("accounts")
}

/// Email verification and password reset tokens for Better Auth
model Verification {
  id         String   @id @default(uuid()) @db.Uuid
  identifier String   @db.VarChar(255)
  value      String   @db.VarChar(255)
  expiresAt  DateTime @map("expires_at") @db.Timestamptz(6)
  createdAt  DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt  DateTime @updatedAt @map("updated_at") @db.Timestamptz(6)

  @@index([identifier])
  @@index([expiresAt])
  @@map("verifications")
}

/// Time Entry - Core time tracking record (immutable original)
/// Stores clock in/out times with timezone and location data
model TimeEntry {
  id               String          @id @default(uuid()) @db.Uuid
  entityType       String          @map("entity_type") @db.VarChar(50)
  entityId         String          @map("entity_id") @db.Uuid
  clockInTime      DateTime        @map("clock_in_time") @db.Timestamptz(6)
  clockOutTime     DateTime?       @map("clock_out_time") @db.Timestamptz(6)
  timezone         String          @db.VarChar(50)
  clockInLocation  Json?           @map("clock_in_location")
  clockOutLocation Json?           @map("clock_out_location")
  entryType        TimeEntryType   @map("entry_type")
  entrySource      EntrySource     @map("entry_source")
  workType         String?         @map("work_type") @db.VarChar(50)
  projectId        String?         @map("project_id") @db.Uuid
  departmentCode   String?         @map("department_code") @db.VarChar(50)
  costCenter       String?         @map("cost_center") @db.VarChar(50)
  status           TimeEntryStatus @default(draft)
  totalMinutes     Int?            @map("total_minutes")
  createdAt        DateTime        @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt        DateTime        @updatedAt @map("updated_at") @db.Timestamptz(6)
  createdById      String          @map("created_by_id") @db.Uuid
  isDeleted        Boolean         @default(false) @map("is_deleted")
  deletedAt        DateTime?       @map("deleted_at") @db.Timestamptz(6)
  amendments       TimeAmendment[]
  approvals        TimeApproval[]
  breaks           TimeBreak[]
  createdBy        User            @relation("TimeEntryCreatedBy", fields: [createdById], references: [id])

  @@index([entityType, entityId, clockInTime])
  @@index([status, clockInTime])
  @@index([clockInTime])
  @@map("time_entries")
}

/// Time Break - Break tracking (meal, rest, etc.)
model TimeBreak {
  id             String    @id @default(uuid()) @db.Uuid
  timeEntryId    String    @map("time_entry_id") @db.Uuid
  startTime      DateTime  @map("start_time") @db.Timestamptz(6)
  endTime        DateTime? @map("end_time") @db.Timestamptz(6)
  breakType      BreakType @map("break_type")
  isPaid         Boolean   @default(false) @map("is_paid")
  isAutoDeducted Boolean   @default(false) @map("is_auto_deducted")
  createdAt      DateTime  @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt      DateTime  @updatedAt @map("updated_at") @db.Timestamptz(6)
  createdById    String    @map("created_by_id") @db.Uuid
  isDeleted      Boolean   @default(false) @map("is_deleted")
  deletedAt      DateTime? @map("deleted_at") @db.Timestamptz(6)
  createdBy      User      @relation("TimeBreakCreatedBy", fields: [createdById], references: [id])
  timeEntry      TimeEntry @relation(fields: [timeEntryId], references: [id], onDelete: Cascade)

  @@index([timeEntryId])
  @@map("time_breaks")
}

/// Time Amendment - Audit trail for all changes to time entries
/// Append-only, immutable record of modifications
model TimeAmendment {
  id               String        @id @default(uuid()) @db.Uuid
  timeEntryId      String        @map("time_entry_id") @db.Uuid
  amendmentType    AmendmentType @map("amendment_type")
  fieldChanged     String?       @map("field_changed") @db.VarChar(50)
  oldValue         String?       @map("old_value")
  newValue         String?       @map("new_value")
  reason           String
  requiresApproval Boolean       @default(true) @map("requires_approval")
  isApproved       Boolean?      @map("is_approved")
  approvedById     String?       @map("approved_by_id") @db.Uuid
  approvedAt       DateTime?     @map("approved_at") @db.Timestamptz(6)
  createdAt        DateTime      @default(now()) @map("created_at") @db.Timestamptz(6)
  createdById      String        @map("created_by_id") @db.Uuid
  approvedBy       User?         @relation("TimeAmendmentApprovedBy", fields: [approvedById], references: [id])
  createdBy        User          @relation("TimeAmendmentCreatedBy", fields: [createdById], references: [id])
  timeEntry        TimeEntry     @relation(fields: [timeEntryId], references: [id], onDelete: Cascade)

  @@index([timeEntryId, createdAt])
  @@index([isApproved, createdAt])
  @@map("time_amendments")
}

/// Time Approval - Multi-level approval workflow
/// Append-only, immutable approval records
model TimeApproval {
  id            String           @id @default(uuid()) @db.Uuid
  timeEntryId   String           @map("time_entry_id") @db.Uuid
  approvalLevel Int
  approverRole  String           @map("approver_role") @db.VarChar(50)
  decision      ApprovalDecision
  comments      String?
  decidedAt     DateTime         @map("decided_at") @db.Timestamptz(6)
  decidedById   String           @map("decided_by_id") @db.Uuid
  decidedBy     User             @relation("TimeApprovalDecidedBy", fields: [decidedById], references: [id])
  timeEntry     TimeEntry        @relation(fields: [timeEntryId], references: [id], onDelete: Cascade)

  @@index([timeEntryId])
  @@index([decidedById])
  @@index([decision])
  @@map("time_approvals")
}

/// Hours Adjustment - Manual adjustments to hours (comp time, corrections, etc.)
model HoursAdjustment {
  id              String         @id @default(uuid()) @db.Uuid
  entityType      String         @map("entity_type") @db.VarChar(50)
  entityId        String         @map("entity_id") @db.Uuid
  payPeriodStart  DateTime       @map("pay_period_start") @db.Date
  payPeriodEnd    DateTime       @map("pay_period_end") @db.Date
  adjustmentType  AdjustmentType @map("adjustment_type")
  hours           Float
  reason          String
  referenceNumber String?        @map("reference_number") @db.VarChar(100)
  isApproved      Boolean        @default(false) @map("is_approved")
  approvedById    String?        @map("approved_by_id") @db.Uuid
  approvedAt      DateTime?      @map("approved_at") @db.Timestamptz(6)
  createdAt       DateTime       @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt       DateTime       @updatedAt @map("updated_at") @db.Timestamptz(6)
  createdById     String         @map("created_by_id") @db.Uuid
  isDeleted       Boolean        @default(false) @map("is_deleted")
  deletedAt       DateTime?      @map("deleted_at") @db.Timestamptz(6)
  approvedBy      User?          @relation("AdjustmentApprovedBy", fields: [approvedById], references: [id])
  createdBy       User           @relation("AdjustmentCreatedBy", fields: [createdById], references: [id])

  @@index([entityType, entityId, payPeriodStart])
  @@index([payPeriodStart])
  @@map("hours_adjustments")
}

/// Work Rule - Jurisdiction-specific labor law compliance rules
/// Defines overtime thresholds, break requirements, hour limits per jurisdiction
model WorkRule {
  id               String    @id @default(uuid()) @db.Uuid
  name             String    @db.VarChar(200)
  jurisdiction     String    @db.VarChar(100)
  effectiveDate    DateTime  @map("effective_date") @db.Date
  expiryDate       DateTime? @map("expiry_date") @db.Date
  overtimeRules    Json      @map("overtime_rules")
  breakRules       Json      @map("break_rules")
  weeklyHourLimits Json?     @map("weekly_hour_limits")
  createdAt        DateTime  @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt        DateTime  @updatedAt @map("updated_at") @db.Timestamptz(6)

  @@index([jurisdiction, effectiveDate])
  @@map("work_rules")
}

/// WCB Claims - Workers' Compensation Board Claims Management
/// Tracks workplace injury/illness claims with bidirectional entity linking
model WcbClaim {
  id                  String         @id @default(uuid()) @db.Uuid
  claimNumber         String         @unique @map("claim_number") @db.VarChar(50)
  wcbClaimNumber      String?        @map("wcb_claim_number") @db.VarChar(50)
  status              WcbClaimStatus @default(new)

  // Incident details
  incidentDate        DateTime       @map("incident_date") @db.Timestamptz(6)
  location            String?        @db.VarChar(255)
  province            String         @db.VarChar(2)
  incidentDetails     String         @map("incident_details")

  // Injury information
  injuryType          String?        @map("injury_type") @db.VarChar(100)
  bodyPartAffected    String?        @map("body_part_affected") @db.VarChar(100)
  severityLevel       String?        @map("severity_level") @db.VarChar(50)

  // Medical information
  reportedToDoctor    Boolean        @default(false) @map("reported_to_doctor")
  firstContactDate    DateTime?      @map("first_contact_date") @db.Date
  doctorName          String?        @map("doctor_name") @db.VarChar(255)
  doctorPhone         String?        @map("doctor_phone") @db.VarChar(20)
  medicalFacility     String?        @map("medical_facility") @db.VarChar(255)

  // WCB contact
  wcbContactName      String?        @map("wcb_contact_name") @db.VarChar(255)
  wcbContactPhone     String?        @map("wcb_contact_phone") @db.VarChar(20)
  wcbContactEmail     String?        @map("wcb_contact_email") @db.VarChar(254)

  // Return to work
  expectedReturnDate  DateTime?      @map("expected_return_date") @db.Date
  actualReturnDate    DateTime?      @map("actual_return_date") @db.Date
  lostTimeDays        Int?           @default(0) @map("lost_time_days")

  // Financial
  estimatedCost       Decimal?       @map("estimated_cost") @db.Decimal(12, 2)
  actualCost          Decimal?       @map("actual_cost") @db.Decimal(12, 2)

  // Notes
  statusNote          String?        @map("status_note")
  remarksComments     String?        @map("remarks_comments")

  // Generic entity linking
  entityType          String         @map("entity_type") @db.VarChar(50)
  entityId            String         @map("entity_id") @db.Uuid

  // Audit fields
  createdAt           DateTime       @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt           DateTime       @updatedAt @map("updated_at") @db.Timestamptz(6)
  createdById         String         @map("created_by_id") @db.Uuid
  updatedById         String         @map("updated_by_id") @db.Uuid
  isDeleted           Boolean        @default(false) @map("is_deleted")
  deletedAt           DateTime?      @map("deleted_at") @db.Timestamptz(6)

  // Relations
  createdBy           User            @relation("WcbClaimCreatedBy", fields: [createdById], references: [id])
  updatedBy           User            @relation("WcbClaimUpdatedBy", fields: [updatedById], references: [id])
  // Removed hardcoded employee relation - use generic entityType + entityId instead

  @@index([entityType, entityId])
  @@index([status])
  @@index([incidentDate])
  @@index([province])
  @@map("wcb_claims")
}

enum EmployeeStatus {
  new
  under_review
  application_on_hold
  rejected
  offer_accepted
  trainee
  active
  resigned
  vacation
  on_leave
  wcb
  terminated
  suspended
}

enum EmploymentType {
  full_time
  part_time
  contract
}

enum DocumentType {
  government_id
  work_authorization
  sin_ssn
  direct_deposit
  tax_forms
  resume
  background_check_consent
  employment_contract
  company_policies
  confidentiality_agreement
  benefits_enrollment
  professional_certifications
  education_verification
  safety_training
  immigration_documents
  other_documents
  profile_photo
  wcb_worker_report
  wcb_employer_report
  wcb_medical_report
}

enum EntityType {
  employees
  time_entries
  adjustments
  wcb_claims
}

enum ActivityType {
  employment
  education
  unemployment
  self_employed
  military_service
  other
}

enum TimeEntryType {
  regular_work
  overtime
  sick_leave
  vacation
  personal_leave
  unpaid_leave
  holiday
  bereavement
  jury_duty
  training
  other
}

enum EntrySource {
  mobile_app
  web_portal
  time_clock_kiosk
  admin_manual
  system_import
  api
}

enum TimeEntryStatus {
  draft
  submitted
  approved
  rejected
  locked
  disputed
}

enum BreakType {
  meal_break
  rest_break
  coffee_break
  other
}

enum AmendmentType {
  time_correction
  type_change
  break_adjustment
  admin_override
  system_correction
}

enum ApprovalDecision {
  approved
  rejected
  needs_correction
  escalated
}

enum AdjustmentType {
  manual_correction
  comp_time
  pto_adjustment
  holiday_pay
  bonus_hours
  penalty_deduction
  other
}

enum WcbClaimStatus {
  new
  submitted
  accepted
  denied
  closed
}
